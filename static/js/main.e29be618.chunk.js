(this["webpackJsonplibrary-management-system"]=this["webpackJsonplibrary-management-system"]||[]).push([[0],{101:function(e,n,a){},102:function(e,n,a){},104:function(e,n,a){"use strict";a.r(n);var t=a(0),s=a.n(t),r=a(14),i=a.n(r),c=a(24),o=a(26),l=a(25),u=a(16),d=a(59);a(92),a(107),a(105);d.a.initializeApp({apiKey:"AIzaSyBBYCDggpHEho-sMOj_HxvgSC2wetbSUB8",authDomain:"library-management-syste-57f9f.firebaseapp.com",projectId:"library-management-syste-57f9f",storageBucket:"library-management-syste-57f9f.appspot.com",messagingSenderId:"659487115186",appId:"1:659487115186:web:4eed8326ab5cd4c63f86ab",measurementId:"G-LT3BJB781F"}),d.a.analytics();var h=d.a,b=a(54),g=a(108),m=a(147),p=a(140),f=a(146),j=a(141),O=a(149),C=a(142),k=a(41),v=a.n(k),S=(a(95),a(5)),x=h.firestore(),y=function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(e){var t;return Object(c.a)(this,a),(t=n.call(this,e)).handleTabValueChange=function(e,n){t.setState((function(){return{tabValue:n}}))},t.handleInputChange=function(e){var n=e.target.getAttribute("name"),a=e.target.value;t.setState((function(){return Object(b.a)({},n,a)}))},t.handleSnackbarClose=function(){t.setState((function(){return{isSnackbarOpen:!1,snackbarMessage:""}}))},t.handleLoginSubmit=function(e){e.preventDefault(),h.auth().signInWithEmailAndPassword(t.state.loginEmail,t.state.loginPassword).catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},t.handleRegisterSubmit=function(e){e.preventDefault(),t.state.registerPassword===t.state.registerPasswordConfirm?""!==t.state.registerAdminKey?x.collection("AdminKeys").where("Keys","!=",[]).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),0!==n.length&&-1!==n[0].Keys.indexOf(t.state.registerAdminKey)?t.registerUser(!0):t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Invalid Admin Keys"}}))})).catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))})):t.registerUser(!1):t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Passwords do not match."}}))},t.registerUser=function(e){h.auth().createUserWithEmailAndPassword(t.state.registerEmail,t.state.registerPassword).then((function(n){n.user.updateProfile({displayName:t.state.registerUsername}).then((function(){x.collection("Users").doc(n.user.uid).set({isAdmin:e}).then((function(){n.user.sendEmailVerification().catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){t.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},t.render=function(){return Object(S.jsxs)("div",{className:"LoginRegister",children:[Object(S.jsxs)(g.a,{elevation:3,className:"LoginRegister-FormContainer",children:[Object(S.jsxs)(m.a,{value:t.state.tabValue,onChange:t.handleTabValueChange,children:[Object(S.jsx)(p.a,{label:"Login"}),Object(S.jsx)(p.a,{label:"Register"})]}),0===t.state.tabValue?Object(S.jsxs)("form",{onSubmit:t.handleLoginSubmit,className:"LoginRegister-Form",children:[Object(S.jsx)(f.a,{label:"Email",type:"email",required:!0,name:"loginEmail",value:t.state.loginEmail,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"loginPassword",value:t.state.loginPassword,onChange:t.handleInputChange}),Object(S.jsx)(j.a,{type:"submit",children:"Log In"})]}):Object(S.jsxs)("form",{onSubmit:t.handleRegisterSubmit,className:"LoginRegister-Form",children:[Object(S.jsx)(f.a,{label:"Username",required:!0,name:"registerUsername",value:t.state.registerUsername,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{label:"Email",type:"email",required:!0,name:"registerEmail",value:t.state.registerEmail,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"registerPassword",value:t.state.registerPassword,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{label:"Confirm Password",type:"password",required:!0,name:"registerPasswordConfirm",value:t.state.registerPasswordConfirm,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{type:"password",label:"Admin Key",name:"registerAdminKey",value:t.state.registerAdminKey,onChange:t.handleInputChange}),Object(S.jsx)(j.a,{type:"submit",children:"Register"})]})]}),Object(S.jsx)(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t.state.isSnackbarOpen,autoHideDuration:6e3,onClose:t.handleSnackbarClose,message:t.state.snackbarMessage,action:Object(S.jsx)(s.a.Fragment,{children:Object(S.jsx)(C.a,{size:"small","aria-label":"close",color:"inherit",onClick:t.handleSnackbarClose,children:Object(S.jsx)(v.a,{fontSize:"small"})})})})]})},t.state={tabValue:0,loginEmail:"",loginPassword:"",registerUsername:"",registerEmail:"",registerPassword:"",registerPasswordConfirm:"",registerAdminKey:"",isSnackbarOpen:!1,snackbarMessage:""},t}return a}(t.Component),w=a(143),E=a(144),A=a(145),I=a(81),M=a(150),L=a(79),P=a.n(L),F=a(80),N=a.n(F),U=(a(101),function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(e){var t;return Object(c.a)(this,a),(t=n.call(this,e)).handleAccountMenuOpen=function(){t.setState((function(){return{isAccountMenuOpen:!0}}))},t.handleAccountMenuClose=function(){t.setState((function(){return{isAccountMenuOpen:!1}}))},t.handleChangeFocus=function(){t.props.handleChangeFocus("Profile")},t.render=function(){return Object(S.jsxs)(w.a,{position:"sticky",className:"Header",children:[Object(S.jsxs)(E.a,{className:"Header-Toolbar",children:[Object(S.jsx)(A.a,{variant:"h6",children:"Library Management System"}),Object(S.jsx)(C.a,{color:"inherit",onClick:t.handleAccountMenuOpen,className:"Header-AccountButton",children:Object(S.jsx)(P.a,{})})]}),Object(S.jsxs)(I.a,{anchorEl:document.querySelector(".Header-AccountButton"),keepMounted:!0,open:t.state.isAccountMenuOpen,onClose:t.handleAccountMenuClose,children:[Object(S.jsxs)(M.a,{children:[t.props.userIsAdmin?Object(S.jsx)(N.a,{className:"Header-AdminIcon"}):"",t.props.user.displayName]}),Object(S.jsx)(M.a,{onClick:t.handleChangeFocus,children:"Profile"}),Object(S.jsx)(M.a,{onClick:t.props.handleLogout,children:"Logout"})]})]})},t.state={isAccountMenuOpen:!1},t}return a}(t.Component)),R=function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return(e=n.call.apply(n,[this].concat(s))).handleChangeFocus=function(){e.props.handleChangeFocus("Library")},e.render=function(){return Object(S.jsx)("div",{className:"Profile",children:Object(S.jsx)(j.a,{onClick:e.handleChangeFocus,children:"Back to Library"})})},e}return a}(t.Component),V=function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(){var e;Object(c.a)(this,a);for(var t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return(e=n.call.apply(n,[this].concat(s))).render=function(){return Object(S.jsx)("div",{className:"Library",children:Object(S.jsx)("h1",{children:"Library"})})},e}return a}(t.Component),B=function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(e){var t;return Object(c.a)(this,a),(t=n.call(this,e)).handleLogout=function(){h.auth().signOut()},t.handleSnackbarOpen=function(e){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:e}}))},t.handleSnackbarClose=function(){t.setState((function(){return{snackbarOpen:!1,snackbarMessage:""}}))},t.handleChangeFocus=function(e){t.setState((function(){return{componentInFocus:e}}))},t.render=function(){return Object(S.jsxs)("div",{className:"Homepage",children:[Object(S.jsx)(U,{user:t.props.user,userIsAdmin:t.props.userIsAdmin,handleSnackbarOpen:t.handleSnackbarOpen,handleLogout:t.handleLogout,handleChangeFocus:t.handleChangeFocus}),"Library"===t.state.componentInFocus&&Object(S.jsx)(V,{}),"Profile"===t.state.componentInFocus&&Object(S.jsx)(R,{handleChangeFocus:t.handleChangeFocus}),Object(S.jsx)(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t.state.snackbarOpen,autoHideDuration:6e3,onClose:t.handleSnackbarClose,message:t.state.snackbarMessage,action:Object(S.jsx)(s.a.Fragment,{children:Object(S.jsx)(C.a,{size:"small","aria-label":"close",color:"inherit",onClick:t.handleSnackbarClose,children:Object(S.jsx)(v.a,{fontSize:"small"})})})})]})},t.state={isSnackbarOpen:!1,snackbarMessage:"",componentInFocus:"Library"},t}return a}(t.Component),z=(a(102),function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(e){var t;return Object(c.a)(this,a),(t=n.call(this,e)).handleSnackbarClose=function(){t.setState((function(){return{snackbarOpen:!1,snackbarMessage:""}}))},t.handleLogout=function(){h.auth().signOut()},t.handleReload=function(){window.location.reload()},t.handleResend=function(){t.props.user.sendEmailVerification().then((function(){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:"Email Resent to ".concat(t.props.user.email,".")}}))})).catch((function(e){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:e.message}}))}))},t.handleEmailChangeToggle=function(){t.setState((function(e){return{isUserChangingEmail:!e.isUserChangingEmail}}))},t.handleInputChange=function(e){var n=e.target.getAttribute("name"),a=e.target.value;t.setState((function(){return Object(b.a)({},n,a)}))},t.handleEmailChangeSubmit=function(e){e.preventDefault();var n=h.auth.EmailAuthProvider.credential(t.props.user.email,t.state.passwordInput);t.props.user.reauthenticateWithCredential(n).then((function(){t.props.user.updateEmail(t.state.newEmailInput).then((function(){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:"Email changed to ".concat(t.state.newEmailInput),isUserChangingEmail:!1,newEmailInput:"",passwordInput:""}}),(function(){t.props.user.reload()}))})).catch((function(e){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){t.setState((function(){return{snackbarOpen:!0,snackbarMessage:e.message}}))}))},t.render=function(){return Object(S.jsxs)("div",{className:"VerifyEmail",children:[Object(S.jsxs)(A.a,{children:[t.props.user.displayName,", please Verify Email at"," ",t.props.user.email,"."]}),Object(S.jsx)(j.a,{onClick:t.handleResend,children:"Resend Email"}),Object(S.jsx)(j.a,{onClick:t.handleReload,children:"Already Verified?"}),Object(S.jsx)(j.a,{onClick:t.handleEmailChangeToggle,children:"Change Email Address"}),t.state.isUserChangingEmail?Object(S.jsx)(g.a,{className:"VerifyEmail-FormContainer",children:Object(S.jsxs)("form",{onSubmit:t.handleEmailChangeSubmit,className:"VerifyEmail-Form",children:[Object(S.jsx)(f.a,{label:"New Email Address",type:"email",required:!0,name:"newEmailInput",value:t.state.newEmailInput,onChange:t.handleInputChange}),Object(S.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"passwordInput",value:t.state.passwordInput,onChange:t.handleInputChange}),Object(S.jsx)(j.a,{type:"submit",children:"Submit"})]})}):null,Object(S.jsx)(j.a,{color:"secondary",onClick:t.handleLogout,children:"Logout"}),Object(S.jsx)(O.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:t.state.snackbarOpen,autoHideDuration:6e3,onClose:t.handleSnackbarClose,message:t.state.snackbarMessage,action:Object(S.jsx)(s.a.Fragment,{children:Object(S.jsx)(C.a,{size:"small","aria-label":"close",color:"inherit",onClick:t.handleSnackbarClose,children:Object(S.jsx)(v.a,{fontSize:"small"})})})})]})},t.state={snackbarOpen:!1,snackbarMessage:"",isUserChangingEmail:!1,newEmailInput:"",passwordInput:""},t}return a}(t.Component)),H=h.firestore(),K=function(e){Object(o.a)(a,e);var n=Object(l.a)(a);function a(e){var t;return Object(c.a)(this,a),(t=n.call(this,e)).componentDidMount=function(){t.checkLogin()},t.checkLogin=function(){h.auth().onAuthStateChanged((function(e){e?H.collection("Users").doc(e.uid).get().then((function(n){var a=!!n.data()&&n.data().isAdmin;t.setState((function(){return{user:e,userIsAdmin:a}}))})).catch((function(e){alert(e.message),h.auth().signOut()})):t.setState((function(){return{user:!1}}))}))},t.render=function(){return Object(S.jsx)("div",{className:"App",children:Object(S.jsxs)(u.d,{children:[Object(S.jsx)(u.b,{exact:!0,path:"/library-management-system/login",children:t.state.user?Object(S.jsx)(u.a,{to:{pathname:"/library-management-system"}}):Object(S.jsx)(y,{})}),Object(S.jsx)(u.b,{exact:!0,path:"/library-management-system",children:t.state.user?t.state.user.emailVerified?Object(S.jsx)(B,{user:t.state.user,userIsAdmin:t.state.userIsAdmin}):Object(S.jsx)(z,{user:t.state.user}):Object(S.jsx)(u.a,{to:{pathname:"/library-management-system/login"}})})]})})},t.state={user:!1,userIsAdmin:!1},t}return a}(t.Component),W=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var T=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,151)).then((function(n){var a=n.getCLS,t=n.getFID,s=n.getFCP,r=n.getLCP,i=n.getTTFB;a(e),t(e),s(e),r(e),i(e)}))},q=a(66);i.a.render(Object(S.jsx)(s.a.StrictMode,{children:Object(S.jsx)(q.a,{children:Object(S.jsx)(K,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/library-management-system",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/library-management-system","/service-worker.js");W?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var t=a.headers.get("content-type");404===a.status||null!=t&&-1===t.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):D(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):D(n,e)}))}}(),T()},95:function(e,n,a){}},[[104,1,2]]]);
//# sourceMappingURL=main.e29be618.chunk.js.map