(this["webpackJsonplibrary-management-system"]=this["webpackJsonplibrary-management-system"]||[]).push([[0],{121:function(e,n,t){},127:function(e,n,t){},128:function(e,n,t){},130:function(e,n,t){},131:function(e,n,t){},132:function(e,n,t){},133:function(e,n,t){},134:function(e,n,t){},136:function(e,n,t){"use strict";t.r(n);var a=t(0),s=t.n(a),r=t(14),i=t.n(r),c=t(19),o=t(21),l=t(20),d=t(17),u=t(79);t(118),t(138),t(137);u.a.initializeApp({apiKey:"AIzaSyBBYCDggpHEho-sMOj_HxvgSC2wetbSUB8",authDomain:"library-management-syste-57f9f.firebaseapp.com",projectId:"library-management-syste-57f9f",storageBucket:"library-management-syste-57f9f.appspot.com",messagingSenderId:"659487115186",appId:"1:659487115186:web:4eed8326ab5cd4c63f86ab",measurementId:"G-LT3BJB781F"}),u.a.analytics();var h=u.a,p=t(36),j=t(104),b=t(199),m=t(176),f=t(198),O=t(179),g=t(200),x=t(139),v=t(28),C=t.n(v),y=(t(121),t(1)),S=h.firestore(),w=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).handleTabValueChange=function(e,n){a.setState((function(){return{tabValue:n}}))},a.handleInputChange=function(e){var n=e.target.getAttribute("name"),t=e.target.value;a.setState((function(){return Object(p.a)({},n,t)}))},a.handleSnackbarClose=function(){a.setState((function(){return{isSnackbarOpen:!1,snackbarMessage:""}}))},a.handleLoginSubmit=function(e){e.preventDefault(),h.auth().signInWithEmailAndPassword(a.state.loginEmail,a.state.loginPassword).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},a.handleRegisterSubmit=function(e){e.preventDefault(),a.state.registerPassword===a.state.registerPasswordConfirm?""!==a.state.registerAdminKey?S.collection("AdminKeys").where("Keys","!=",[]).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),0!==n.length&&-1!==n[0].Keys.indexOf(a.state.registerAdminKey)?a.registerUser(!0):a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Invalid Admin Key"}}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))})):a.registerUser(!1):a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Passwords do not match."}}))},a.registerUser=function(e){h.auth().createUserWithEmailAndPassword(a.state.registerEmail,a.state.registerPassword).then((function(n){n.user.updateProfile({displayName:a.state.registerUsername}).then((function(){S.collection("Users").doc(n.user.uid).set({isAdmin:e}).then((function(){n.user.sendEmailVerification().catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},a.handleForgotPassword=function(){a.state.loginEmail?h.auth().sendPasswordResetEmail(a.state.loginEmail).then((function(){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Password Reset Link sent at ".concat(a.state.loginEmail)}}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))})):a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Please enter your Email address."}}))},a.render=function(){return Object(y.jsxs)("div",{className:"LoginRegister",children:[Object(y.jsxs)(j.a,{elevation:3,className:"LoginRegister-FormContainer",children:[Object(y.jsxs)(b.a,{value:a.state.tabValue,onChange:a.handleTabValueChange,children:[Object(y.jsx)(m.a,{label:"Login"}),Object(y.jsx)(m.a,{label:"Register"})]}),0===a.state.tabValue?Object(y.jsxs)("form",{onSubmit:a.handleLoginSubmit,className:"LoginRegister-Form",children:[Object(y.jsx)(f.a,{label:"Email",type:"email",required:!0,name:"loginEmail",value:a.state.loginEmail,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"loginPassword",value:a.state.loginPassword,onChange:a.handleInputChange}),Object(y.jsx)(O.a,{type:"submit",children:"Log In"}),Object(y.jsx)(O.a,{size:"small",onClick:a.handleForgotPassword,children:"Forgot password?"})]}):Object(y.jsxs)("form",{onSubmit:a.handleRegisterSubmit,className:"LoginRegister-Form",children:[Object(y.jsx)(f.a,{label:"Username",required:!0,name:"registerUsername",value:a.state.registerUsername,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Email",type:"email",required:!0,name:"registerEmail",value:a.state.registerEmail,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"registerPassword",value:a.state.registerPassword,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Confirm Password",type:"password",required:!0,name:"registerPasswordConfirm",value:a.state.registerPasswordConfirm,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{type:"password",label:"Admin Key",name:"registerAdminKey",value:a.state.registerAdminKey,onChange:a.handleInputChange}),Object(y.jsx)(O.a,{type:"submit",children:"Register"})]})]}),Object(y.jsx)(g.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a.state.isSnackbarOpen,autoHideDuration:6e3,onClose:a.handleSnackbarClose,message:a.state.snackbarMessage,action:Object(y.jsx)(s.a.Fragment,{children:Object(y.jsx)(x.a,{size:"small","aria-label":"close",color:"inherit",onClick:a.handleSnackbarClose,children:Object(y.jsx)(C.a,{fontSize:"small"})})})})]})},a.state={tabValue:0,loginEmail:"",loginPassword:"",registerUsername:"",registerEmail:"",registerPassword:"",registerPasswordConfirm:"",registerAdminKey:"",isSnackbarOpen:!1,snackbarMessage:""},a}return t}(a.Component),k=t(180),I=t(181),D=t(60),A=t(103),E=t(182),P=t(96),R=t.n(P),q=t(97),U=t.n(q),N=t(95),T=t.n(N),F=(t(127),function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).handleAccountMenuOpen=function(){a.setState((function(){return{isAccountMenuOpen:!0}}))},a.handleAccountMenuClose=function(){a.setState((function(){return{isAccountMenuOpen:!1}}))},a.handleChangeFocus=function(){a.props.handleChangeFocus("Profile"),a.handleAccountMenuClose()},a.render=function(){return Object(y.jsxs)(k.a,{position:"sticky",className:"Header",children:[Object(y.jsxs)(I.a,{className:"Header-Toolbar",children:[Object(y.jsxs)("div",{className:"Header-ToolbarLeft",children:[Object(y.jsx)(x.a,{color:"inherit",onClick:a.props.handleDrawerOpen,children:Object(y.jsx)(T.a,{})}),Object(y.jsx)(D.a,{variant:"h6",noWrap:!0,children:"Library Management System"})]}),Object(y.jsx)(x.a,{color:"inherit",onClick:a.handleAccountMenuOpen,className:"Header-AccountButton",children:Object(y.jsx)(R.a,{})})]}),Object(y.jsxs)(A.a,{anchorEl:document.querySelector(".Header-AccountButton"),keepMounted:!0,open:a.state.isAccountMenuOpen,onClose:a.handleAccountMenuClose,children:[Object(y.jsxs)(E.a,{children:[a.props.isUserAdmin?Object(y.jsx)(U.a,{className:"Header-AdminIcon"}):"",a.props.user.displayName]}),Object(y.jsx)(E.a,{onClick:a.handleChangeFocus,children:"Profile"}),Object(y.jsx)(E.a,{onClick:a.props.handleLogout,children:"Logout"})]})]})},a.state={isAccountMenuOpen:!1},a}return t}(a.Component)),L=t(201),M=t(183),B=t(184),K=t(54),W=t.n(K),V=t(98),H=t.n(V),Q=(t(128),h.firestore()),z=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).componentDidMount=function(){a.unSubAdminKeys=Q.collection("AdminKeys").where("Keys","!=",[]).onSnapshot((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),n[0]&&a.setState((function(){return{adminKey:n[0].Keys}}))}))},a.componentWillUnmount=function(){a.unSubAdminKeys()},a.handleChangeFocus=function(){a.props.handleChangeFocus(a.props.isUserAdmin?"Inventory":"Library")},a.handleInputChange=function(e){var n=e.target.getAttribute("name"),t=e.target.value;a.setState((function(){return Object(p.a)({},n,t)}))},a.handleChangeDisplayNameExpandedToggle=function(e,n){a.setState((function(){return{isChangeDisplayNameExpanded:n}}))},a.handleChangeDisplayNameSubmit=function(e){e.preventDefault(),a.props.user.updateProfile({displayName:a.state.newUsername}).then((function(){a.setState((function(){return{newUsername:"",isChangeDisplayNameExpanded:!1}}),(function(){a.props.handleSnackbarOpen("Username Updated.")}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))},a.handleChangeEmailExpandedToggle=function(e,n){a.setState((function(){return{isChangeEmailExpanded:n}}))},a.handleChangeEmailSubmit=function(e){e.preventDefault();var n=h.auth.EmailAuthProvider.credential(a.props.user.email,a.state.newEmailPassword);a.props.user.reauthenticateWithCredential(n).then((function(){a.props.user.updateEmail(a.state.newEmail).then((function(){a.props.user.sendEmailVerification().then((function(){a.setState((function(){return{newEmail:"",newPassword:"",isChangeEmailExpanded:!1}}),(function(){a.props.handleSnackbarOpen("Email Updated. Verify New Email Address."),window.location.reload()}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))},a.handleChangePasswordExpandedToggle=function(e,n){a.setState((function(){return{isChangePasswordExpanded:n}}))},a.handleChangePasswordSubmit=function(e){if(e.preventDefault(),a.state.newPassword===a.state.newPasswordConfirm){var n=h.auth.EmailAuthProvider.credential(a.props.user.email,a.state.oldPassword);a.props.user.reauthenticateWithCredential(n).then((function(){a.props.user.updatePassword(a.state.newPassword).then((function(){a.setState((function(){return{oldPassword:"",newPassword:"",newPasswordConfirm:"",isChangePasswordExpanded:!1}}),(function(){a.props.handleSnackbarOpen("Password Updated.")}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))}else a.props.handleSnackbarOpen("New Passwords do not match.")},a.handleChangeAdminKeysExpandedToggle=function(e,n){a.setState((function(){return{isChangeAdminKeysExpanded:n}}))},a.handleChangeAdminKeysSubmit=function(e){e.preventDefault(),Q.collection("AdminKeys").where("Keys","!=",[]).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.ref)})),n[0]?n[0].update({Keys:a.state.newAdminKey}).then((function(){a.setState((function(){return{newAdminKey:"",isChangeAdminKeysExpanded:!1}}),(function(){a.props.handleSnackbarOpen("Updated AdminKey.")}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)})):a.props.handleSnackbarOpen("Error while fetching AdminKey.")})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))},a.handleDeleteAccountExpandedToggle=function(e,n){a.setState((function(){return{isDeleteAccountExpanded:n}}))},a.handleDeleteAccountSubmit=function(e){e.preventDefault();var n=h.auth.EmailAuthProvider.credential(a.props.user.email,a.state.deletePassword);a.props.user.reauthenticateWithCredential(n).then((function(){Q.collection("Users").doc(a.props.user.uid).delete().then((function(){a.props.user.delete().catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))},a.render=function(){return Object(y.jsxs)("div",{className:"Profile",children:[Object(y.jsx)("div",{className:"Profile-BackButtonContainer",children:Object(y.jsxs)(O.a,{onClick:a.handleChangeFocus,children:["Back to ",a.props.isUserAdmin?"Inventory":"Library"]})}),Object(y.jsxs)("div",{children:[Object(y.jsxs)(L.a,{expanded:a.state.isChangeDisplayNameExpanded,onChange:a.handleChangeDisplayNameExpandedToggle,children:[Object(y.jsxs)(M.a,{expandIcon:a.state.isChangeDisplayNameExpanded?Object(y.jsx)(C.a,{}):Object(y.jsx)(W.a,{}),children:[Object(y.jsx)(D.a,{children:"Username"}),Object(y.jsx)(D.a,{children:a.props.user.displayName})]}),Object(y.jsx)(B.a,{children:Object(y.jsxs)("form",{className:"Profile-AccordionForm",onSubmit:a.handleChangeDisplayNameSubmit,children:[Object(y.jsx)(f.a,{label:"New Username",name:"newUsername",value:a.state.newUsername,onChange:a.handleInputChange,required:!0}),Object(y.jsx)(O.a,{type:"submit",children:"Submit"})]})})]}),Object(y.jsxs)(L.a,{expanded:a.state.isChangeEmailExpanded,onChange:a.handleChangeEmailExpandedToggle,children:[Object(y.jsxs)(M.a,{expandIcon:a.state.isChangeEmailExpanded?Object(y.jsx)(C.a,{}):Object(y.jsx)(W.a,{}),children:[Object(y.jsx)(D.a,{children:"Email"}),Object(y.jsx)(D.a,{children:a.props.user.email})]}),Object(y.jsx)(B.a,{children:Object(y.jsxs)("form",{className:"Profile-AccordionForm",onSubmit:a.handleChangeEmailSubmit,children:[Object(y.jsx)(f.a,{label:"New Email",name:"newEmail",value:a.state.newEmail,onChange:a.handleInputChange,required:!0}),Object(y.jsx)(f.a,{label:"Password",name:"newEmailPassword",value:a.state.newEmailPassword,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(O.a,{type:"submit",children:"Submit"})]})})]}),Object(y.jsxs)(L.a,{expanded:a.state.isChangePasswordExpanded,onChange:a.handleChangePasswordExpandedToggle,children:[Object(y.jsx)(M.a,{expandIcon:a.state.isChangePasswordExpanded?Object(y.jsx)(C.a,{}):Object(y.jsx)(W.a,{}),children:Object(y.jsx)(D.a,{children:"Password"})}),Object(y.jsx)(B.a,{children:Object(y.jsxs)("form",{className:"Profile-AccordionForm",onSubmit:a.handleChangePasswordSubmit,children:[Object(y.jsx)(f.a,{label:"Current Password",name:"oldPassword",value:a.state.oldPassword,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(f.a,{label:"New Password",name:"newPassword",value:a.state.newPassword,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(f.a,{label:"Confirm New Password",name:"newPasswordConfirm",value:a.state.newPasswordConfirm,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(O.a,{type:"submit",children:"Submit"})]})})]}),a.props.isUserAdmin?Object(y.jsxs)(L.a,{expanded:a.state.isChangeAdminKeysExpanded,onChange:a.handleChangeAdminKeysExpandedToggle,children:[Object(y.jsxs)(M.a,{expandIcon:a.state.isChangeAdminKeysExpanded?Object(y.jsx)(C.a,{}):Object(y.jsx)(W.a,{}),children:[Object(y.jsx)(D.a,{children:"Admin Key"}),Object(y.jsx)(D.a,{children:a.state.adminKey})]}),Object(y.jsx)(B.a,{children:Object(y.jsxs)("form",{className:"Profile-AccordionForm",onSubmit:a.handleChangeAdminKeysSubmit,children:[Object(y.jsx)(f.a,{label:"New Admin Key",name:"newAdminKey",value:a.state.newAdminKey,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(O.a,{type:"submit",children:"Submit"})]})})]}):null,Object(y.jsxs)(L.a,{expanded:a.state.isDeleteAccountExpanded,onChange:a.handleDeleteAccountExpandedToggle,children:[Object(y.jsx)(M.a,{expandIcon:Object(y.jsx)(H.a,{}),children:Object(y.jsx)(D.a,{children:"Delete Account"})}),Object(y.jsx)(B.a,{children:Object(y.jsxs)("form",{className:"Profile-AccordionForm",onSubmit:a.handleDeleteAccountSubmit,children:[Object(y.jsx)(f.a,{label:"Password",name:"deletePassword",value:a.state.deletePassword,onChange:a.handleInputChange,type:"password",required:!0}),Object(y.jsx)(O.a,{type:"submit",color:"secondary",children:"Delete Account"})]})})]})]})]})},a.state={isChangeDisplayNameExpanded:!1,newUsername:"",isChangeEmailExpanded:!1,newEmail:"",newEmailPassword:"",isChangePasswordExpanded:!1,oldPassword:"",newPassword:"",newPasswordConfirm:"",isChangeAdminKeysExpanded:!1,newAdminKey:"",isDeleteAccountExpanded:!1,deletePassword:"",adminKey:""},a}return t}(a.Component),J=t(40),Y=t.n(J),_=t(59),G=t(53),$=t(185),X=t(186),Z=t(187),ee=t(188),ne=t(189),te=t(190),ae=t(191),se=t(192),re=t(193),ie=t(194),ce=t(195),oe=t(77),le=t.n(oe),de=t.p+"static/media/defaultBook.3309b0ae.png",ue=(t(130),h.firestore()),he=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).componentDidMount=function(){a.unSubInventory=ue.collection("Inventory").where("quantity",">",0).onSnapshot((function(e){var n=[];e.forEach(function(){var e=Object(G.a)(Y.a.mark((function e(t){var s,r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="https://www.googleapis.com/books/v1/volumes/"+t.data().id,e.prev=1,e.next=4,fetch(s);case 4:return r=e.sent,e.next=7,r.json();case 7:(i=e.sent)?(n.push(Object(_.a)(Object(_.a)({},i),{},{quantity:t.data().quantity,price:t.data().price})),a.setState((function(){return{library:n}}))):a.props.handleSnackbarOpen("Book Id not found."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.props.handleSnackbarOpen(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}())})),a.unSubDontShow=ue.collection("Requests").where("userID","==",a.props.user.uid).onSnapshot((function(e){var n=[];e.forEach((function(e){"pending"!==e.data().history[e.data().history.length-1].status&&"approved"!==e.data().history[e.data().history.length-1].status&&"collected"!==e.data().history[e.data().history.length-1].status||n.push(e.data().bookID)})),a.setState((function(){return{dontShow:n}}))}))},a.componentWillUnmount=function(){a.unSubInventory(),a.unSubDontShow()},a.handleDialogClose=function(){a.setState((function(){return{isRequestDialogOpen:!1,requestId:""}}))},a.handleRequestDialogOpen=function(e){a.setState((function(){return{isRequestDialogOpen:!0,requestId:e}}))},a.handleRequest=function(){ue.collection("Requests").where("userID","==",a.props.user.uid).where("bookID","==",a.state.requestId).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),!n[0]||"pending"!==n[0].history[n[0].history.length-1].status&&"approved"!==n[0].history[n[0].history.length-1].status&&"collected"!==n[0].history[n[0].history.length-1].status?ue.collection("Requests").where("userID","==",a.props.user.uid).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.data())})),n.filter((function(e){return"pending"===e.history[e.history.length-1].status||"approved"===e.history[e.history.length-1].status||"collected"===e.history[e.history.length-1].status})).length>=3?a.props.handleSnackbarOpen("Request Limit Exceeded."):ue.collection("Requests").add({userID:a.props.user.uid,bookID:a.state.requestId,history:[{status:"pending",time:h.firestore.Timestamp.fromDate(new Date(Date.now()))}]}).then((function(){a.handleDialogClose(),a.props.handleSnackbarOpen("Request Sent to Admin.")})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)})):a.props.handleSnackbarOpen("Book Already Requested")})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))},a.render=function(){return Object(y.jsxs)("div",{className:"Library",children:[Object(y.jsx)(D.a,{variant:"h3",children:"Library"}),a.state.library.length>0&&Object(y.jsx)($.a,{component:j.a,children:Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{children:"Title"}),Object(y.jsx)(ne.a,{children:"Authors"}),Object(y.jsx)(ne.a,{children:"Publisher"}),Object(y.jsx)(ne.a,{children:"Published Date"}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.library.map((function(e){return-1===a.state.dontShow.indexOf(e.id)&&Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:Object(y.jsx)("img",{src:e.volumeInfo.imageLinks?e.volumeInfo.imageLinks.thumbnail:de,alt:e.title})}),Object(y.jsx)(ne.a,{children:e.volumeInfo.title?e.volumeInfo.title:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.authors?e.volumeInfo.authors.join(", "):""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publisher?e.volumeInfo.publisher:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publishedDate?e.volumeInfo.publishedDate:""}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{onClick:function(){a.handleRequestDialogOpen(e.id)},disabled:a.state.dontShow.length>=3,children:Object(y.jsx)(le.a,{})})})]},e.id)}))})]})}),Object(y.jsxs)(ae.a,{open:a.state.isRequestDialogOpen,onClose:a.handleDialogClose,children:[Object(y.jsx)(se.a,{children:"Confirm Request to Borrow."}),Object(y.jsx)(re.a,{children:Object(y.jsxs)(ie.a,{children:["The price of this book is \u20b9",a.state.isRequestDialogOpen?a.state.library.find((function(e){return e.id===a.state.requestId})).price:"",". If unable to return the book within 7 days a fine of \u20b910/week will be charged."]})}),Object(y.jsxs)(ce.a,{children:[Object(y.jsx)(O.a,{onClick:a.handleDialogClose,color:"primary",children:"Cancel"}),Object(y.jsx)(O.a,{onClick:a.handleRequest,color:"primary",children:"Confirm"})]})]})]})},a.state={library:[],dontShow:[],isRequestDialogOpen:!1,requestId:""},a}return t}(a.Component),pe=t(202),je=t(178),be=t(140),me=t(196),fe=t(197),Oe=t(99),ge=t.n(Oe),xe=t(100),ve=t.n(xe),Ce=t(101),ye=t.n(Ce),Se=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(){var e;Object(c.a)(this,t);for(var a=arguments.length,s=new Array(a),r=0;r<a;r++)s[r]=arguments[r];return(e=n.call.apply(n,[this].concat(s))).handleInventoryClick=function(){e.props.handleChangeFocus("Inventory"),e.props.handleDrawerClose()},e.handleLibraryClick=function(){e.props.handleChangeFocus("Library"),e.props.handleDrawerClose()},e.handleRequestsClick=function(){e.props.handleChangeFocus("Requests"),e.props.handleDrawerClose()},e.render=function(){return Object(y.jsx)(pe.a,{anchor:"left",open:e.props.isDrawerOpen,onClose:e.props.handleDrawerClose,className:"Drawer",children:Object(y.jsxs)(je.a,{children:[e.props.isUserAdmin&&Object(y.jsxs)(be.a,{button:!0,onClick:e.handleInventoryClick,children:[Object(y.jsx)(me.a,{children:Object(y.jsx)(ge.a,{})}),Object(y.jsx)(fe.a,{primary:"Inventory"})]},"Inventory"),!e.props.isUserAdmin&&Object(y.jsxs)(be.a,{button:!0,onClick:e.handleLibraryClick,children:[Object(y.jsx)(me.a,{children:Object(y.jsx)(ve.a,{})}),Object(y.jsx)(fe.a,{primary:"Library"})]},"Library"),e.props.isUserAdmin&&Object(y.jsxs)(be.a,{button:!0,onClick:e.handleRequestsClick,children:[Object(y.jsx)(me.a,{children:Object(y.jsx)(ye.a,{})}),Object(y.jsx)(fe.a,{primary:"Requests"})]},"Requests")]})})},e}return t}(a.Component),we=t(102),ke=t.n(we),Ie=(t(131),h.firestore()),De=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).componentDidMount=function(){a.unsubInventoryListener=Ie.collection("Inventory").onSnapshot((function(e){var n=[];e.forEach(function(){var e=Object(G.a)(Y.a.mark((function e(t){var s,r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="https://www.googleapis.com/books/v1/volumes/"+t.data().id,e.prev=1,e.next=4,fetch(s);case 4:return r=e.sent,e.next=7,r.json();case 7:(i=e.sent)?(n.push(Object(_.a)(Object(_.a)({},i),{},{quantity:t.data().quantity,price:t.data().price})),a.setState((function(){return{inventory:n}}))):a.props.handleSnackbarOpen("Book Id not found."),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),a.props.handleSnackbarOpen(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}())}))},a.componentWillUnmount=function(){a.unsubInventoryListener()},a.handleInputChange=function(e){var n=e.target.getAttribute("name"),t=e.target.value;a.setState((function(){return Object(p.a)({},n,t)}))},a.toggleAddItem=function(){a.setState((function(e){return{addItem:!e.addItem}}))},a.handleSearchSubmit=function(){var e=Object(G.a)(Y.a.mark((function e(n){var t,s,r;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a.state.searchTitle||a.state.searchAuthor||a.state.searchPublisher||a.state.searchISBN){e.next=5;break}a.props.handleSnackbarOpen("Please Enter at least 1 field."),e.next=24;break;case 5:return t="https://www.googleapis.com/books/v1/volumes?q=",a.state.searchTitle&&(t+="intitle:".concat(a.state.searchTitle)),a.state.searchAuthor&&(a.state.searchTitle?t+="+inauthor:".concat(a.state.searchAuthor):t+="inauthor:".concat(a.state.searchAuthor)),a.state.searchPublisher&&(a.state.searchTitle||a.state.searchAuthor?t+="+inpublisher:".concat(a.state.searchPublisher):t+="inpublisher:".concat(a.state.searchPublisher)),a.state.searchISBN&&(a.state.searchTitle||a.state.searchAuthor||a.state.searchPublisher?t+="+isbn:".concat(a.state.searchISBN):t+="isbn:".concat(a.state.searchISBN)),t+="&key=".concat("AIzaSyBBYCDggpHEho-sMOj_HxvgSC2wetbSUB8"),e.prev=11,e.next=14,fetch(t);case 14:return s=e.sent,e.next=17,s.json();case 17:(r=e.sent).items?a.setState((function(){return{searchResult:r.items}})):a.props.handleSnackbarOpen("No results found."),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(11),a.props.handleSnackbarOpen(e.t0.message);case 24:case"end":return e.stop()}}),e,null,[[11,21]])})));return function(n){return e.apply(this,arguments)}}(),a.handleDialogClose=function(){a.setState((function(){return{isAddDialogOpen:!1,isEditDialogOpen:!1,isDeleteDialogOpen:!1,addId:"",editId:"",idToBeDeleted:""}}))},a.handleAddItemDialogOpen=function(e){a.setState((function(){return{addId:e,isAddDialogOpen:!0}}))},a.handleAddSubmit=function(e){e.preventDefault(),Ie.collection("Inventory").where("id","==",a.state.addId).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e)})),n.length>0?(a.handleDialogClose(),a.props.handleSnackbarOpen("Duplicate Item.")):Ie.collection("Inventory").add({id:a.state.addId,quantity:parseInt(a.state.addQuantity),price:parseFloat(a.state.addPrice)}).then((function(){a.setState((function(){return{isAddDialogOpen:!1,addQuantity:"",addPrice:"",addId:"",addItem:!1,searchTitle:"",searchAuthor:"",searchPublisher:"",searchISBN:"",searchResult:[]}}),(function(){a.props.handleSnackbarOpen("Added to Inventory")}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))},a.handleEditItemDialogOpen=function(e){a.setState((function(n){var t=n.inventory.find((function(n){return n.id===e})).quantity,a=n.inventory.find((function(n){return n.id===e})).price;return{editId:e,isEditDialogOpen:!0,editQuantity:t,editPrice:a}}))},a.handleEditSubmit=function(e){e.preventDefault(),Ie.collection("Inventory").where("id","==",a.state.editId).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.ref)})),n.length>0?n[0].update({quantity:parseInt(a.state.editQuantity),price:parseFloat(a.state.editPrice)}).then((function(){a.setState((function(){return{isEditDialogOpen:!1,editQuantity:"",editPrice:"",editId:""}}),(function(){a.props.handleSnackbarOpen("Updated Inventory")}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)})):(a.handleDialogClose(),a.props.handleSnackbarOpen("Unexpected Error."))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))},a.handleDeleteDialogOpen=function(e){a.setState((function(){return{isDeleteDialogOpen:!0,idToBeDeleted:e}}))},a.handleDeleteItem=function(){Ie.collection("Inventory").where("id","==",a.state.idToBeDeleted).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.ref)})),n[0].delete().then((function(){a.setState((function(){return{isDeleteDialogOpen:!1,idToBeDeleted:""}}),(function(){a.props.handleSnackbarOpen("Item successfully deleted!")}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))},a.render=function(){return Object(y.jsxs)("div",{className:"Inventory",children:[Object(y.jsx)(D.a,{variant:"h3",children:"Inventory"}),Object(y.jsxs)(j.a,{className:"Inventory-AddItem",children:[Object(y.jsx)(O.a,{onClick:a.toggleAddItem,children:"Add Book"}),a.state.addItem&&Object(y.jsxs)("div",{children:[Object(y.jsxs)("form",{onSubmit:a.handleSearchSubmit,className:"Inventory-AddItemForm",children:[Object(y.jsx)(D.a,{variant:"h4",children:"Search for a book"}),Object(y.jsx)(f.a,{label:"Title",name:"searchTitle",value:a.state.searchTitle,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Author",name:"searchAuthor",value:a.state.searchAuthor,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Publisher",name:"searchPublisher",value:a.state.searchPublisher,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"ISBN",InputProps:{inputProps:{pattern:"[0-9]{10}|[0-9]{13}"}},name:"searchISBN",value:a.state.searchISBN,onChange:a.handleInputChange}),Object(y.jsx)(O.a,{type:"submit",children:"Search"})]}),a.state.searchResult.length>0&&Object(y.jsxs)($.a,{component:j.a,children:[Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{children:"Title"}),Object(y.jsx)(ne.a,{children:"Authors"}),Object(y.jsx)(ne.a,{children:"Publisher"}),Object(y.jsx)(ne.a,{children:"Category"}),Object(y.jsx)(ne.a,{children:"Published Date"}),Object(y.jsx)(ne.a,{children:"Number of Pages"}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.searchResult.map((function(e){return Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:Object(y.jsx)("img",{src:e.volumeInfo.imageLinks?e.volumeInfo.imageLinks.thumbnail:de,alt:e.title})}),Object(y.jsx)(ne.a,{children:e.volumeInfo.title?e.volumeInfo.title:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.authors?e.volumeInfo.authors.join(", "):""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publisher?e.volumeInfo.publisher:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.categories?e.volumeInfo.categories.join(", "):""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publishedDate?e.volumeInfo.publishedDate:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.pageCount?e.volumeInfo.pageCount:""}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{onClick:function(){a.handleAddItemDialogOpen(e.id)},children:Object(y.jsx)(le.a,{})})})]},e.id)}))})]}),Object(y.jsx)(D.a,{children:"Please search for specific terms if unable to find required book."})]})]})]}),a.state.inventory.length>0&&Object(y.jsx)($.a,{component:j.a,children:Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{children:"Title"}),Object(y.jsx)(ne.a,{children:"Authors"}),Object(y.jsx)(ne.a,{children:"Publisher"}),Object(y.jsx)(ne.a,{children:"Published Date"}),Object(y.jsx)(ne.a,{children:"Price (\u20b9)"}),Object(y.jsx)(ne.a,{children:"Quantity"}),Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.inventory.map((function(e){return Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:Object(y.jsx)("img",{src:e.volumeInfo.imageLinks?e.volumeInfo.imageLinks.thumbnail:de,alt:e.title})}),Object(y.jsx)(ne.a,{children:e.volumeInfo.title?e.volumeInfo.title:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.authors?e.volumeInfo.authors.join(", "):""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publisher?e.volumeInfo.publisher:""}),Object(y.jsx)(ne.a,{children:e.volumeInfo.publishedDate?e.volumeInfo.publishedDate:""}),Object(y.jsx)(ne.a,{children:e.price?e.price:""}),Object(y.jsx)(ne.a,{children:e.quantity?e.quantity:""}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{onClick:function(){a.handleEditItemDialogOpen(e.id)},children:Object(y.jsx)(W.a,{})})}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{onClick:function(){a.handleDeleteDialogOpen(e.id)},color:"secondary",children:Object(y.jsx)(ke.a,{})})})]},e.id)}))})]})}),Object(y.jsx)(ae.a,{open:a.state.isAddDialogOpen,onClose:a.handleDialogClose,children:Object(y.jsxs)("form",{onSubmit:a.handleAddSubmit,children:[Object(y.jsx)(se.a,{children:"Add to inventory"}),Object(y.jsxs)(re.a,{children:[Object(y.jsx)(ie.a,{children:a.state.isAddDialogOpen?a.state.searchResult.find((function(e){return e.id===a.state.addId})).volumeInfo.title:""}),Object(y.jsx)(f.a,{required:!0,type:"number",value:a.state.addQuantity,onChange:a.handleInputChange,name:"addQuantity",label:"Quantity",InputProps:{inputProps:{min:0}},fullWidth:!0}),Object(y.jsx)(f.a,{required:!0,type:"number",value:a.state.addPrice,onChange:a.handleInputChange,name:"addPrice",label:"Price (\u20b9)",InputProps:{inputProps:{min:0,step:"any"}},fullWidth:!0})]}),Object(y.jsxs)(ce.a,{children:[Object(y.jsx)(O.a,{onClick:a.handleDialogClose,color:"primary",children:"Cancel"}),Object(y.jsx)(O.a,{color:"primary",type:"submit",children:"Add"})]})]})}),Object(y.jsx)(ae.a,{open:a.state.isEditDialogOpen,onClose:a.handleDialogClose,children:Object(y.jsxs)("form",{onSubmit:a.handleEditSubmit,children:[Object(y.jsx)(se.a,{children:"Edit inventory"}),Object(y.jsxs)(re.a,{children:[Object(y.jsx)(ie.a,{children:a.state.isEditDialogOpen?a.state.inventory.find((function(e){return e.id===a.state.editId})).volumeInfo.title:""}),Object(y.jsx)(f.a,{required:!0,type:"number",value:a.state.editQuantity,onChange:a.handleInputChange,name:"editQuantity",label:"Quantity",InputProps:{inputProps:{min:0}},fullWidth:!0}),Object(y.jsx)(f.a,{required:!0,type:"number",value:a.state.editPrice,onChange:a.handleInputChange,name:"editPrice",label:"Price (\u20b9)",InputProps:{inputProps:{min:0,step:"any"}},fullWidth:!0})]}),Object(y.jsxs)(ce.a,{children:[Object(y.jsx)(O.a,{onClick:a.handleDialogClose,color:"primary",children:"Cancel"}),Object(y.jsx)(O.a,{color:"primary",type:"submit",children:"Save"})]})]})}),Object(y.jsxs)(ae.a,{open:a.state.isDeleteDialogOpen,onClose:a.handleDialogClose,children:[Object(y.jsx)(se.a,{children:"Confirm Deletion."}),Object(y.jsxs)(ce.a,{children:[Object(y.jsx)(O.a,{onClick:a.handleDialogClose,color:"primary",children:"Cancel"}),Object(y.jsx)(O.a,{onClick:a.handleDeleteItem,color:"secondary",children:"Delete"})]})]})]})},a.state={addItem:!1,searchTitle:"",searchAuthor:"",searchPublisher:"",searchISBN:"",searchResult:[],isAddDialogOpen:!1,addId:"",addQuantity:"",addPrice:"",inventory:[],isEditDialogOpen:!1,editId:"",editQuantity:"",editPrice:"",isDeleteDialogOpen:!1,idToBeDeleted:""},a}return t}(a.Component),Ae=t(80),Ee=t.n(Ae),Pe=(t(132),h.firestore()),Re=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).componentDidMount=function(){a.unSubRequests=Pe.collection("Requests").onSnapshot((function(e){var n=[];e.forEach(function(){var e=Object(G.a)(Y.a.mark((function e(t){var s,r,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s="https://www.googleapis.com/books/v1/volumes/"+t.data().bookID,e.next=4,fetch(s);case 4:return r=e.sent,e.next=7,r.json();case 7:i=e.sent,n.push({title:i.volumeInfo.title,bookID:t.data().bookID,userID:t.data().userID,status:t.data().history[t.data().history.length-1].status}),a.setState((function(){return{requests:n}})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),a.props.handleSnackbarOpen(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(n){return e.apply(this,arguments)}}())}))},a.componentWillUnmount=function(){a.unSubRequests()},a.toTitleCase=function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))},a.handleDialogClose=function(){a.setState((function(){return{isApproveRejectDialogOpen:!1,toApproveReject:{},approveRejectReason:""}}))},a.handleApproveAccept=function(e,n,t){Pe.collection("Requests").where("bookID","==",e).where("userID","==",n).get().then((function(e){var s=[];e.forEach((function(e){return s.push(e.ref)})),s[0].update({history:h.firestore.FieldValue.arrayUnion({status:"approved",time:h.firestore.Timestamp.fromDate(new Date(Date.now()))})}).then((function(){Pe.collection("Notifications").add({userID:n,message:"".concat(t," has been approved by Admin for you to borrow and is now ready for collection."),time:h.firestore.Timestamp.fromDate(new Date(Date.now())),isRead:!1}).then((function(){a.props.handleSnackbarOpen("".concat(t," approved for ").concat(n,"."))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.props.handleSnackbarOpen(e.message)}))},a.handleApproveRejectDialogOpen=function(e,n,t){a.setState((function(){return{isApproveRejectDialogOpen:!0,toApproveReject:{bookID:e,userID:n,title:t}}}))},a.handleInputChange=function(e){var n=e.target.getAttribute("name"),t=e.target.value;a.setState((function(){return Object(p.a)({},n,t)}))},a.handleApproveReject=function(e){e.preventDefault(),Pe.collection("Requests").where("userID","==",a.state.toApproveReject.userID).where("bookID","==",a.state.toApproveReject.bookID).get().then((function(e){var n=[];e.forEach((function(e){return n.push(e.ref)})),n[0].update({history:h.firestore.FieldValue.arrayUnion({status:"rejected",time:h.firestore.Timestamp.fromDate(new Date(Date.now()))})}).then(Pe.collection("Notifications").add({userID:a.state.toApproveReject.userID,message:"".concat(a.state.toApproveReject.title," has been Rejected by Admin for you to borrow for the following reason: ").concat(a.state.approveRejectReason),time:h.firestore.Timestamp.fromDate(new Date(Date.now())),isRead:!1}).then((function(){a.props.handleSnackbarOpen("".concat(a.state.toApproveReject.title," rejected for ").concat(a.state.toApproveReject.userID,".")),a.handleDialogClose()})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))})).catch((function(e){a.handleDialogClose(),a.props.handleSnackbarOpen(e.message)}))},a.render=function(){return Object(y.jsxs)("div",{className:"Requests",children:[Object(y.jsx)(D.a,{variant:"h3",children:"Requests"}),a.state.requests.filter((function(e){return"pending"===e.status})).length>0&&Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"h5",children:"Not yet Approved"}),Object(y.jsx)($.a,{component:j.a,children:Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:"Book Title"}),Object(y.jsx)(ne.a,{children:"User ID"}),Object(y.jsx)(ne.a,{children:"Status"}),Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.requests.filter((function(e){return"pending"===e.status})).map((function(e){return Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:e.title}),Object(y.jsx)(ne.a,{children:e.userID}),Object(y.jsx)(ne.a,{children:a.toTitleCase(e.status)}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{color:"primary",onClick:function(){a.handleApproveAccept(e.bookID,e.userID,e.title)},children:Object(y.jsx)(Ee.a,{})})}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{onClick:function(){a.handleApproveRejectDialogOpen(e.bookID,e.userID,e.title)},color:"secondary",children:Object(y.jsx)(C.a,{})})})]},e.bookID+e.userID)}))})]})})]}),a.state.requests.filter((function(e){return"approved"===e.status})).length>0&&Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"h5",children:"Not yet Collected"}),Object(y.jsx)($.a,{children:Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:"Book Title"}),Object(y.jsx)(ne.a,{children:"User ID"}),Object(y.jsx)(ne.a,{children:"Status"}),Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.requests.filter((function(e){return"approved"===e.status})).map((function(e){return Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:e.title}),Object(y.jsx)(ne.a,{children:e.userID}),Object(y.jsx)(ne.a,{children:a.toTitleCase(e.status)}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{color:"primary",children:Object(y.jsx)(Ee.a,{})})}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{color:"secondary",children:Object(y.jsx)(C.a,{})})})]},e.title+e.userID)}))})]})})]}),a.state.requests.filter((function(e){return"collected"===e.status})).length>0&&Object(y.jsxs)("div",{children:[Object(y.jsx)(D.a,{variant:"h5",children:"Not yet Returned"}),Object(y.jsx)($.a,{children:Object(y.jsxs)(X.a,{children:[Object(y.jsx)(Z.a,{children:Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:"Book Title"}),Object(y.jsx)(ne.a,{children:"User ID"}),Object(y.jsx)(ne.a,{children:"Status"}),Object(y.jsx)(ne.a,{}),Object(y.jsx)(ne.a,{})]})}),Object(y.jsx)(te.a,{children:a.state.requests.filter((function(e){return"collected"===e.status})).map((function(e){return Object(y.jsxs)(ee.a,{children:[Object(y.jsx)(ne.a,{children:e.title}),Object(y.jsx)(ne.a,{children:e.userID}),Object(y.jsx)(ne.a,{children:a.toTitleCase(e.status)}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{color:"primary",children:Object(y.jsx)(Ee.a,{})})}),Object(y.jsx)(ne.a,{children:Object(y.jsx)(x.a,{color:"secondary",children:Object(y.jsx)(C.a,{})})})]},e.title+e.userID)}))})]})})]}),Object(y.jsx)(ae.a,{open:a.state.isApproveRejectDialogOpen,onClose:a.handleDialogClose,children:Object(y.jsxs)("form",{onSubmit:a.handleApproveReject,children:[Object(y.jsx)(se.a,{children:"Confirm Rejection"}),Object(y.jsxs)(re.a,{children:[Object(y.jsxs)(D.a,{variant:"h6",children:["Title: ",a.state.toApproveReject.title," "]}),Object(y.jsxs)(D.a,{children:["User ID: ",a.state.toApproveReject.userID," "]}),Object(y.jsx)(f.a,{value:a.state.approveRejectReason,name:"approveRejectReason",onChange:a.handleInputChange,label:"Reason",multiline:!0,required:!0})]}),Object(y.jsxs)(ce.a,{children:[Object(y.jsx)(O.a,{onClick:a.handleDialogClose,color:"primary",children:"Cancel"}),Object(y.jsx)(O.a,{type:"submit",color:"secondary",children:"Reject"})]})]})})]})},a.state={requests:[],isApproveRejectDialogOpen:!1,toApproveReject:{},approveRejectReason:""},a}return t}(a.Component),qe=(t(133),function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).handleLogout=function(){h.auth().signOut()},a.handleSnackbarOpen=function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e}}))},a.handleSnackbarClose=function(){a.setState((function(){return{isSnackbarOpen:!1,snackbarMessage:""}}))},a.handleChangeFocus=function(e){a.setState((function(){return{componentInFocus:e}}))},a.handleDrawerClose=function(){a.setState((function(){return{isDrawerOpen:!1}}))},a.handleDrawerOpen=function(){a.setState((function(){return{isDrawerOpen:!0}}))},a.render=function(){return Object(y.jsxs)("div",{className:"Homepage",children:[Object(y.jsx)(F,{user:a.props.user,isUserAdmin:a.props.isUserAdmin,handleSnackbarOpen:a.handleSnackbarOpen,handleLogout:a.handleLogout,handleChangeFocus:a.handleChangeFocus,handleDrawerOpen:a.handleDrawerOpen}),"Library"===a.state.componentInFocus&&!a.props.isUserAdmin&&Object(y.jsx)(he,{user:a.props.user,handleSnackbarOpen:a.handleSnackbarOpen}),"Profile"===a.state.componentInFocus&&Object(y.jsx)(z,{handleChangeFocus:a.handleChangeFocus,user:a.props.user,isUserAdmin:a.props.isUserAdmin,handleSnackbarOpen:a.handleSnackbarOpen}),"Inventory"===a.state.componentInFocus&&a.props.isUserAdmin&&Object(y.jsx)(De,{handleSnackbarOpen:a.handleSnackbarOpen}),"Requests"===a.state.componentInFocus&&a.props.isUserAdmin&&Object(y.jsx)(Re,{handleSnackbarOpen:a.handleSnackbarOpen}),Object(y.jsx)(Se,{isDrawerOpen:a.state.isDrawerOpen,handleDrawerClose:a.handleDrawerClose,isUserAdmin:a.props.isUserAdmin,handleChangeFocus:a.handleChangeFocus}),Object(y.jsx)(g.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a.state.isSnackbarOpen,autoHideDuration:6e3,onClose:a.handleSnackbarClose,message:a.state.snackbarMessage,action:Object(y.jsx)(s.a.Fragment,{children:Object(y.jsx)(x.a,{size:"small","aria-label":"close",color:"inherit",onClick:a.handleSnackbarClose,children:Object(y.jsx)(C.a,{fontSize:"small"})})})})]})},a.state={isSnackbarOpen:!1,snackbarMessage:"",componentInFocus:a.props.isUserAdmin?"Inventory":"Library",isDrawerOpen:!1},a}return t}(a.Component)),Ue=(t(134),function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).handleSnackbarClose=function(){a.setState((function(){return{isSnackbarOpen:!1,snackbarMessage:""}}))},a.handleLogout=function(){h.auth().signOut()},a.handleReload=function(){window.location.reload()},a.handleResend=function(){a.props.user.sendEmailVerification().then((function(){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Email Resent to ".concat(a.props.user.email,".")}}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},a.handleEmailChangeToggle=function(){a.setState((function(e){return{isUserChangingEmail:!e.isUserChangingEmail}}))},a.handleInputChange=function(e){var n=e.target.getAttribute("name"),t=e.target.value;a.setState((function(){return Object(p.a)({},n,t)}))},a.handleEmailChangeSubmit=function(e){e.preventDefault();var n=h.auth.EmailAuthProvider.credential(a.props.user.email,a.state.passwordInput);a.props.user.reauthenticateWithCredential(n).then((function(){a.props.user.updateEmail(a.state.newEmailInput).then((function(){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:"Email changed to ".concat(a.state.newEmailInput),isUserChangingEmail:!1,newEmailInput:"",passwordInput:""}}),(function(){a.props.user.reload()}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))})).catch((function(e){a.setState((function(){return{isSnackbarOpen:!0,snackbarMessage:e.message}}))}))},a.render=function(){return Object(y.jsxs)("div",{className:"VerifyEmail",children:[Object(y.jsxs)(D.a,{children:[a.props.user.displayName,", please Verify Email at"," ",a.props.user.email,"."]}),Object(y.jsx)(O.a,{onClick:a.handleResend,children:"Resend Email"}),Object(y.jsx)(O.a,{onClick:a.handleReload,children:"Already Verified?"}),Object(y.jsx)(O.a,{onClick:a.handleEmailChangeToggle,children:"Change Email Address"}),a.state.isUserChangingEmail?Object(y.jsx)(j.a,{className:"VerifyEmail-FormContainer",children:Object(y.jsxs)("form",{onSubmit:a.handleEmailChangeSubmit,className:"VerifyEmail-Form",children:[Object(y.jsx)(f.a,{label:"New Email Address",type:"email",required:!0,name:"newEmailInput",value:a.state.newEmailInput,onChange:a.handleInputChange}),Object(y.jsx)(f.a,{label:"Password",type:"password",required:!0,name:"passwordInput",value:a.state.passwordInput,onChange:a.handleInputChange}),Object(y.jsx)(O.a,{type:"submit",children:"Submit"})]})}):null,Object(y.jsx)(O.a,{color:"secondary",onClick:a.handleLogout,children:"Logout"}),Object(y.jsx)(g.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:a.state.isSnackbarOpen,autoHideDuration:6e3,onClose:a.handleSnackbarClose,message:a.state.snackbarMessage,action:Object(y.jsx)(s.a.Fragment,{children:Object(y.jsx)(x.a,{size:"small","aria-label":"close",color:"inherit",onClick:a.handleSnackbarClose,children:Object(y.jsx)(C.a,{fontSize:"small"})})})})]})},a.state={isSnackbarOpen:!1,snackbarMessage:"",isUserChangingEmail:!1,newEmailInput:"",passwordInput:""},a}return t}(a.Component)),Ne=h.firestore(),Te=function(e){Object(o.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(c.a)(this,t),(a=n.call(this,e)).componentDidMount=function(){a.checkLogin()},a.checkLogin=function(){h.auth().onAuthStateChanged((function(e){e?Ne.collection("Users").doc(e.uid).get().then((function(n){var t=!!n.data()&&n.data().isAdmin;a.setState((function(){return{user:e,isUserAdmin:t}}))})).catch((function(e){alert(e.message),h.auth().signOut()})):a.setState((function(){return{user:!1}}))}))},a.render=function(){return Object(y.jsx)("div",{className:"App",children:Object(y.jsxs)(d.d,{children:[Object(y.jsx)(d.b,{exact:!0,path:"/library-management-system/login",children:a.state.user?Object(y.jsx)(d.a,{to:{pathname:"/library-management-system"}}):Object(y.jsx)(w,{})}),Object(y.jsx)(d.b,{exact:!0,path:"/library-management-system",children:a.state.user?a.state.user.emailVerified?Object(y.jsx)(qe,{user:a.state.user,isUserAdmin:a.state.isUserAdmin}):Object(y.jsx)(Ue,{user:a.state.user}):Object(y.jsx)(d.a,{to:{pathname:"/library-management-system/login"}})})]})})},a.state={user:!1,isUserAdmin:!1},a}return t}(a.Component),Fe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Le(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Me=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,203)).then((function(n){var t=n.getCLS,a=n.getFID,s=n.getFCP,r=n.getLCP,i=n.getTTFB;t(e),a(e),s(e),r(e),i(e)}))},Be=t(84);i.a.render(Object(y.jsx)(s.a.StrictMode,{children:Object(y.jsx)(Be.a,{children:Object(y.jsx)(Te,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/library-management-system",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/library-management-system","/service-worker.js");Fe?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Le(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):Le(n,e)}))}}(),Me()}},[[136,1,2]]]);
//# sourceMappingURL=main.cb9eff79.chunk.js.map